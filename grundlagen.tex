\section{Das Entity--Relationship Modell}
\section{Entwurfsmuster: Facade}

\section{Entwurfsmuster: Singleton}

Das Singleton--Entwurfsmuster stellt sicher, dass es in einem Programm von einer Klasse nur ein einziges Mal instanziiert wird. Allen Nutzern der Klasse wird dann eine Referenz auf ebendiese Instanz übergeben, der Zugriff erfolgt jeweils auf die gleichen Daten.

Somit bildet das Singleton--Designpattern eine passende Grundlage für die Nutzerverwaltung, da immer nur ein Benutzer angemeldet sein kann\footnote{Dies gilt jeweils pro Browser--Instanz. In einem weiteren Browserfenster mit eigenen Cookies kann sich ein weiterer Nutzer anmelden, jedoch auch wieder nur einer}.

Das Singleton-Entwurfsmuster kann aufgrund seiner Eigenschaften als objektorientierte Umsetzung von globalen Variablen mit all deren Vor-- und Nachteilen gesehen werden und wird daher auch oft als „Anti--Pattern“ kritisiert\footnote{cite{gof} TODO - Quelle!}

\section{PHP--Schnittstelle --- Session--Cookies}
\section{PHP--Schnittstelle --- PDO}
\section{HTML--Designframework --- Bootstrap}









\section{Datenbank--Schema}

\subsection{Tabelle: user}
\begin{center}
\tablehead{ \textbf{user} & & 
\\ }
\bottomcaption[Beschreibung]{Beschreibung. Quelle: Berger, Vorlesung, 2012, München }
\begin{supertabular}{c|c|c}
\hline
email & varchar(255) &  \\
pw & char(32) &  \\
\end{supertabular}
\end{center}


\begin{figure}[h]
\begin{minted}[bgcolor=bg]{sql}
CREATE TABLE user (
  email VARCHAR(255) NOT NULL,
  pw CHAR(32) NOT NULL,
  create_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`email`));
\end{minted}
\caption{SQL: CREATE TABLE user}
\label{sql:tbluser}
\end{figure}

Als Benutzername wird hierbei die E--Mail Adresse des Administrators genutzt. 

Das Passwort sollte nicht im Klartext in der Datenbank gespeichert werden. Ein \code{salted hash}\footnote{Also der Hashwert des Passworts, welches zuvor mit Applikationsspezifischen Zusatzdaten ergänzt wurde} schützt hier das Passwort vor dem Ausspähen durch den Administrator selbst\footnote{Seit Vodafone 2013 eine dokumentierte Gefahr} oder durch Angreifer.\\
Die hier reservierten 32 Byte sind für den in der MySQL--Dokumentation\footnote{\cite{mysql-pcrypt}} emphohlenen MD5-Hash ausreichend. Da die entsprechende PHP--Dokumentation\footnote{\cite{php-pcrypt}} hier allerdings eine genau entgegengesetzte Empfehlung gibt, ist dieser Sicherheitsaspekt für ein Produktivsystem nochmals genauer zu prüfen.

\subsection{Tabelle: frage}
\begin{figure}[h]
\begin{minted}[bgcolor=bg]{sql}
CREATE TABLE frage (
  fid INT NOT NULL AUTO_INCREMENT,
  txt VARCHAR(1024) NOT NULL,
  PRIMARY KEY (`fid`));
\end{minted}
\caption{SQL: CREATE TABLE frage}
\label{sql:tblfrage}
\end{figure}

\subsection{Tabelle: antwort}
\begin{figure}[h]
\begin{minted}[bgcolor=bg]{sql}
CREATE TABLE antwort (
  aid INT NOT NULL AUTO_INCREMENT,
  nr  INT NULL,
  txt VARCHAR(1024) NOT NULL,
  fid INT NOT NULL,
  PRIMARY KEY (`aid`),
  FOREIGN KEY (`fid`) REFERENCES frage(`fid`));
\end{minted}
\caption{SQL: CREATE TABLE antwort}
\label{sql:tblantwort}
\end{figure}

\subsection{Tabelle: geantwortet}
\begin{figure}[h]
\begin{minted}[bgcolor=bg]{sql}
CREATE TABLE geantwortet (
  gid INT NOT NULL AUTO_INCREMENT,
  aid INT NOT NULL,
  zs TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`gid`),
  FOREIGN KEY (`aid`) REFERENCES antwort(`aid`));
\end{minted}
\caption{SQL: CREATE TABLE geantwortet}
\label{sql:tblgeantwortet}
\end{figure}

\subsection{Query: Frage -- Text}
Wird für die Abfrage und Auswertung benötigt.

\begin{figure}[h]
\begin{minted}[bgcolor=bg]{sql}
select txt from frage where fid = <n>;
\end{minted}
\caption{SQL: Text von Frage <n>}
\label{sql:qfragetxt}
\end{figure}

\subsection{Query: Antwortmöglichkeiten}
Wird für die Abfrage benötigt.

\begin{figure}[h]
\begin{minted}[bgcolor=bg]{sql}
select antwort.txt
	from antwort
	where fid = <n> 
\end{minted}
\caption{SQL: Mögliche Antworten für Frage <n>}
\label{sql:qantwnum}
\end{figure}


\subsection{Query: Anzahl der gegebenen Antworten}
Wird für die Auswertung benötigt: 100\%

\begin{figure}[h]
\begin{minted}[bgcolor=bg]{sql}
select count(geantwortet.aid) 
	from antwort, geantwortet 
	where geantwortet.aid = antwort.aid and antwort.fid = <n>;
\end{minted}
\caption{SQL: Antwortzahl 100\% von Frage <n>}
\label{sql:qantw100}
\end{figure}

\subsection{Query: Gegebene Antworten und Häufigkeit}
Wird für die Auswertung benötigt.

\begin{figure}[h]
\begin{minted}[bgcolor=bg]{sql}
select antwort.txt, count(geantwortet.aid) 
	from antwort, geantwortet 
	where geantwortet.aid = antwort.aid and antwort.fid = <n> 
	group by geantwortet.aid;
\end{minted}
\caption{SQL: Gegebene Antworten mit Häufigkeit für Frage <n>}
\label{sql:qantwnum}
\end{figure}
